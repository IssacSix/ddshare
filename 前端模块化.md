[TOC]

## å‰ç«¯æ¨¡å—åŒ–

### ä¸ºä»€ä¹ˆå‰ç«¯éœ€è¦æ¨¡å—åŒ–ï¼Ÿ

â€‹	ä¸ªäººè®¤ä¸ºï¼Œå‰ç«¯çš„æ¨¡å—åŒ–æ˜¯ä¸€ä¸ªé¡¹ç›®å·¥ç¨‹åŒ–ï¼Œè§„èŒƒåŒ–çš„å¿…ç„¶è¶‹åŠ¿ï¼Œè‡³å°‘ä½œä¸ºå‰ç«¯å°èœé¸Ÿçš„æˆ‘æ˜¯è¿™ä¹ˆè¸©ç€å‘ä¸€æ­¥ä¸€æ­¥è¿‡æ¥çš„ï¼Œæ‰€ä»¥ ç‰ä¼¯ [ã€Šå‰ç«¯æ¨¡å—çš„å¼€å‘çš„æ„ä¹‰ã€‹](https://github.com/seajs/seajs/issues/547) æ˜¯æ·±æ·±çš„å†™è¿›äº†æˆ‘çš„å¿ƒé‡Œã€‚ã€‚ã€‚

#### ç°è±¡æè¿°

å°†ä¸€ä¸ªä¸ªé€šç”¨çš„ã€åº•å±‚çš„åŠŸèƒ½æŠ½è±¡å‡ºæ¥ï¼Œç‹¬ç«‹æˆä¸€ä¸ªå·¥å…·å‡½æ•°ï¼Œæ˜¯ä¸€ä¸ªçŒ¿çš„åŸºæœ¬ä¹ æƒ¯è·Ÿè§‰æ‚Ÿ

```
1.åˆ›å»ºä¸€ä¸ªutil.js
2.å¼€å§‹é€ è½®å­å•¦
	function each () {
      // todo
	}
	
	function log () {
      // todo
	}
3.æ„Ÿè§‰è‡ªå·±æ£’æ£’å“’ ï¼šï¼‰
```

ä¸€å‘¨ï¼Œä¸¤å‘¨ï¼Œä¸€ä¸ªæœˆï¼Œçœ‹ç€utilsé€æ­¥å¥å…¨èµ·æ¥ï¼Œæ·±è¡¨æ¬£æ…°ï¼Œç¾¤ä¼—çš„å‘¼å£°ä¹Ÿæ˜¯æ„ˆæ¥è¶Šé«˜ï¼šä¸ä¸å¥½ç‰›é€¼ï¼ä¸ä¸å¥½å‰å®³ï¼

æ—¥å­ä¸€å¤©å¤©çš„è¿‡å»ï¼Œå›¢é˜Ÿäººæ•°å¢åŠ ï¼Œé¡¹ç›®è¶Šæ¥è¶Šå¤šï¼ŒåŒåæ±¡æŸ“è¶Šæ¥è¶Šä¸¥é‡ã€‚å’‹åŠï¼Ÿç”¨å‘½åç©ºé—´æ¥è§£å†³å§

```
var org = {};
org.CoolSite = {};
org.CoolSite.Utils = {};

org.CoolSite.Utils.each = function (arr) {
  // todo
};

org.CoolSite.Utils.log = function (str) {
  // todo
};
```

oh my goldï¼ ç¨‹åºå‘˜ä½•è‹¦ä¸ºéš¾ç¨‹åºå‘˜ï¼Œèƒ½æ´»ç€å¥½å¥½å†™ä»£ç å·²ç»æ˜¯ä¸€ä»¶ä¸å®¹æ˜“çš„äº‹ï¼Œå°±ä¸ºäº†è°ƒä¸€ä¸ªæ–¹æ³•ï¼Œå±…ç„¶è¿˜è¦è®°ç€ä¹ˆé•¿çš„åå­—ï¼Œå¦‚æœä½ ä¸€äººåŒæ—¶è´Ÿè´£ä¸‰ä¸ªä»¥ä¸Šçš„é¡¹ç›®ï¼Œè¿™ï¼Œï¼Œï¼Œå·²ç»å¼€å§‹æ•´ç†è¡Œæäº†ã€‚

äºæ˜¯ **require.js  common.js** æ¨¡å—åŒ–ç¥å™¨å­•è‚²è€Œç”Ÿäº†ã€‚

#### ç‰ä¼¯çš„æ–‡ç« æœ€åæ€»ç»“æåˆ°çš„æ¨¡å—åŒ–çš„æ„ä¹‰

1. **æ¨¡å—çš„ç‰ˆæœ¬ç®¡ç†** ã€‚é€šè¿‡åˆ«åç­‰é…ç½®ï¼Œé…åˆæ„å»ºå·¥å…·ï¼Œå¯ä»¥æ¯”è¾ƒè½»æ¾åœ°å®ç°æ¨¡å—çš„ç‰ˆæœ¬ç®¡ç†ã€‚
2. **æé«˜å¯ç»´æŠ¤æ€§** ã€‚æ¨¡å—åŒ–å¯ä»¥è®©æ¯ä¸ªæ–‡ä»¶çš„èŒè´£å•ä¸€ï¼Œéå¸¸æœ‰åˆ©äºä»£ç çš„ç»´æŠ¤ã€‚Sea.js è¿˜æä¾›äº† nocacheã€debug ç­‰æ’ä»¶ï¼Œæ‹¥æœ‰åœ¨çº¿è°ƒè¯•ç­‰åŠŸèƒ½ï¼Œèƒ½æ¯”è¾ƒæ˜æ˜¾åœ°æå‡æ•ˆç‡ã€‚
3. **å‰ç«¯æ€§èƒ½ä¼˜åŒ–** ã€‚Sea.js é€šè¿‡å¼‚æ­¥åŠ è½½æ¨¡å—ï¼Œè¿™å¯¹é¡µé¢æ€§èƒ½éå¸¸æœ‰ç›Šã€‚Sea.js è¿˜æä¾›äº† comboã€flush ç­‰æ’ä»¶ï¼Œé…åˆæœåŠ¡ç«¯ï¼Œå¯ä»¥å¾ˆå¥½åœ°å¯¹é¡µé¢æ€§èƒ½è¿›è¡Œè°ƒä¼˜ã€‚
4. **è·¨ç¯å¢ƒå…±äº«æ¨¡å—** ã€‚CMD æ¨¡å—å®šä¹‰è§„èŒƒä¸ Node.js çš„æ¨¡å—è§„èŒƒéå¸¸ç›¸è¿‘ã€‚é€šè¿‡ Sea.js çš„ Node.js ç‰ˆæœ¬ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿å®ç°æ¨¡å—çš„è·¨æœåŠ¡å™¨å’Œæµè§ˆå™¨å…±äº«ã€‚



### å‰ç«¯æ¨¡å—åŒ–çš„å·¥å…·

#### CommonJS

CommonJS å®šä¹‰ä¸€ä¸ªæ¨¡å—

```
CommonJSå®šä¹‰çš„æ¨¡å—åˆ†ä¸º:
	{æ¨¡å—å¼•ç”¨(require)} // require()ç”¨æ¥å¼•å…¥å¤–éƒ¨æ¨¡å—
	{æ¨¡å—å®šä¹‰(exports)} // exportså¯¹è±¡ç”¨äºå¯¼å‡ºå½“å‰æ¨¡å—çš„æ–¹æ³•æˆ–å˜é‡ï¼Œå”¯ä¸€çš„å¯¼å‡ºå£
	{æ¨¡å—æ ‡è¯†(module)}	// moduleå¯¹è±¡å°±ä»£è¡¨æ¨¡å—æœ¬èº«
```

1. CommonJS å¯¹äºä¸€èˆ¬çš„å¼€å‘äººå‘˜å¼€è¯´å¹¶ä¸é™Œç”Ÿï¼Œåº”ç”¨ä¸å¾ˆå¤šåœºæ™¯ï¼Œå„ç§å·¥å…· gulp webpackç­‰éƒ½èƒ½çœ‹åˆ°ã€‚ç®€å•çš„è¯´å°±æ˜¯ module.exports å¯¼å‡ºæ¥çš„å˜é‡ï¼Œ requireæ¥å¼•å…¥å…¶ä»–çš„å˜é‡åˆ°å½“å‰çš„å‡½æ•°ä½œç”¨åŸŸä¸­

2. CommonJS ä¸ CMD çš„å…³ç³»

   **å…¶å®æ²¡æœ‰ç›´æ¥å…³ç³»ï¼**

   ä¸€ç›´ä»¥ä¸ºCMD æ˜¯commonJSçš„è§„èŒƒï¼Œ ç­‰åŒä¸ Require ä¸ AMDä¹‹é—´çš„å…³ç³»ï¼Œå…¶å®ä¸ç„¶ã€‚


   å¸ˆçˆ¶è¯´ï¼ŒCDMä¸¥æ ¼æ„ä¹‰ä¸Šä¸èƒ½ç§°ä½œä¸ºè§„èŒƒï¼Œåªæ˜¯sea.jsçš„ä¸€ä¸ªå€¡è®®

   CommonJSï¼ˆæœåŠ¡ç«¯ï¼‰ AMDï¼ˆæµè§ˆå™¨ï¼‰ æ‰æ˜¯è§„èŒƒï¼ç„¶åå°±è¢«éª‚äº†ä¸€é€šã€‚ã€‚ã€‚

   å¦å¤–CommonJS ä¸èƒ½ç›´æ¥åº”ç”¨äºæµè§ˆå™¨çš„åŸå› ï¼šç¼ºå°‘å››ä¸ªnodeç¯å¢ƒçš„å˜é‡

   * module
   * export
   * require
   * global

##### CMD

1. å®šä¹‰è§„èŒƒ define `define(id?, deps?, factory)`

   ```
   define('hello', ['jquery'], function(require, exports, module) {
     // æ¨¡å—ä»£ç 
   });

   id å’Œ deps å‚æ•°å¯ä»¥çœç•¥ã€‚çœç•¥æ—¶ï¼Œå¯ä»¥é€šè¿‡æ„å»ºå·¥å…·è‡ªåŠ¨ç”Ÿæˆ

   ```

2. ä¸¾ä¸ªæ —å­

   ```
   define(function(require, exports) {

     // è·å–æ¨¡å— a çš„æ¥å£
     var a = require('./a');

     // è°ƒç”¨æ¨¡å— a çš„æ–¹æ³•
     a.doSomething();
     
     module.exports = {
       foo: 'bar',
       doSomethingElse: function() {}
     }
     
   });
   ```




##### module.exports ä¸ exports ç©¶ç«Ÿæœ‰ä»€ä¹ˆåŒºåˆ«

ç®€å•çš„è¯´ï¼Œ module.exports æ˜¯ exportsçš„è¦†ç›–ï¼Œ exportsä»…ä»…æ˜¯module.exportsçš„ä¸€ä¸ªå¼•ç”¨

æ¥ä¸€ä¸ªğŸŒ°

```
modules.exports.age = 18;
exports.name = 'dingding'

var person = require('./test')
console.log('%s is %s', person.name, person.age) // dingding is 18
```

å†æ¥ä¸€ä¸ªğŸŒ°

```
module.exports = 'wtf'
module.exports.age = 18
exports.name = 'dingding'

or 

module.exports.age = 18
exports.name = 'dingding'
module.exports = 'wtf'

var person = require('./test')
console.log(person) 	// wtf
console.log('%s is %s', person.name, person.age) // name and age is not defined
```



#### RequireJs

åŸºäºCommonJsè§„èŒƒçš„node å‡ºæ¥ä»¥åï¼ŒæœåŠ¡ç«¯æ¨¡å—æ¦‚å¿µå·²ç»å½¢æˆï¼Œé‚£ä¹ˆå¾ˆè‡ªç„¶çš„ï¼Œå¤§å®¶éƒ½æƒ³è¦å®¢æˆ·ç«¯æ¨¡å—ã€‚

##### å®¢æˆ·ç«¯æ¨¡å—åŒ–çš„æ„ä¹‰

1. å®ç°jsæ–‡ä»¶çš„å¼‚æ­¥åŠ è½½ï¼Œé¿å…ç½‘é¡µå¤±å»ç›¸åº”ï¼ˆç½‘é€Ÿæ…¢+åŒæ­¥åŠ è½½é˜»å¡ï¼‰
2. ç®¡ç†æ¨¡å—ä¹‹é—´çš„ä¾èµ–æ€§ï¼Œæé«˜ä»£ç çš„ç¼–å†™è·Ÿå¯ç»´æŠ¤æ€§



##### å®ç°æµè§ˆå™¨ç«¯æ¨¡å—åŒ– éœ€è¦è§£å†³çš„é—®é¢˜

é™¤äº†ä¸Šé¢æåˆ°çš„ç¯å¢ƒå˜é‡çš„ç¼ºå¤±ä¹‹å¤–ï¼Œè¿˜æœ‰æµè§ˆå™¨æ–‡ä»¶å¼‚æ­¥åŠ è½½çš„é—®é¢˜ã€‚

æ¥ä¸€ä¸ªğŸŒ°

```
var matn = require('math')
math.add(2,3)
```

æ‰§è¡Œadd æ–¹æ³•å¿…é¡»ç­‰å¾…math.jsåŠ è½½å®Œï¼Œå¦‚æœåŠ è½½çš„æ—¶é—´å¾ˆé•¿ï¼Œé‚£ä¹ˆæ˜¾ç„¶requireæ˜¯åŒæ­¥åŠ è½½

ä¸ºä»€ä¹ˆnodeæ²¡æœ‰è¿™ä¸ªé—®é¢˜ï¼Ÿå› ä¸ºæœåŠ¡ç«¯æ‰€æœ‰çš„æ¨¡å—éƒ½å­˜åœ¨æœ¬åœ°ç£ç›˜ï¼Œå¯ä»¥åŒæ­¥åŠ è½½å®Œæˆï¼Œç­‰å¾…çš„æ—¶é—´å°±æ˜¯ç£ç›˜è¯»å–æ—¶é—´ï¼Œæ‰€ä»¥å¾ˆå¿«ï¼Œä½†æ˜¯ç›¸å¯¹æµè§ˆå™¨ï¼Œå¦‚æœå¿˜è®°å¾ˆæ…¢ï¼Œå°±ä¼šå‡ºç°ä¸€ä¸ªâ€œå‡æ­»â€çŠ¶æ€ã€‚

**é‚£ä¹ˆå¦‚ä½•å®šä¹‰ä¸€ä¸ªå¼‚æ­¥æ¨¡å—** ï¼Ÿ **[AMD](https://github.com/amdjs/amdjs-api/wiki/AMD-(%E4%B8%AD%E6%96%87%E7%89%88)) å°±å‡ºç°äº†**

**Require ä¸ AMD çš„å…³ç³» **

require ä½œä¸ºå‰ç«¯ä¸€ä¸ªæ¨¡å—åŒ–çš„å·¥å…·ï¼Œé‚£ä¹ˆä»¥ä»€ä¹ˆè§„èŒƒå‡†åˆ™æ¥å®šä¹‰ä¸€ä¸ªä¸ªå¼‚æ­¥æ¨¡å—å‘¢ï¼Ÿå›ç­”ï¼šAMD

##### AMD

1. å¯¹AMDä¸å¤ªäº†è§£ï¼Œä¹Ÿä¸å¸¸ç”¨ï¼Œè¿™é‡Œä¸¾ä¸€ä¸ªç®€å•çš„æ —å­ï¼Œè¯¦ç»†å¯ä»¥æŸ¥é˜…ä»¥ä¸Šé“¾æ¥

   ```
   define("alpha", ["require", "exports", "beta"], function (require, exports, beta) {
      exports.verb = function() {
          return beta.verb();
          // æˆ–è€…:
          //return require("beta").verb();
      }
   });
   ```

   â€‹

#### AMD ä¸ CMD çš„å¼‚åŒ

å‚è€ƒåšæ–‡ [ã€Šä¸RequireJSã€‹](https://github.com/seajs/seajs/issues/277)

##### ç›¸åŒä¹‹å¤„

éƒ½æ˜¯æ¨¡å—åŠ è½½å™¨ï¼Œå€¡å¯¼æ¨¡å—åŒ–å¼€å‘çš„ç†å¿µ

##### ä¸åŒä¹‹å¤„

1. å®šä½å·®å¼‚ï¼šRequireJS æƒ³æˆä¸ºæµè§ˆå™¨ç«¯çš„æ¨¡å—åŠ è½½å™¨ï¼ŒåŒæ—¶ä¹Ÿæƒ³æˆä¸º Rhino / Node ç­‰ç¯å¢ƒçš„æ¨¡å—åŠ è½½å™¨ã€‚Sea.js åˆ™ä¸“æ³¨äº Web æµè§ˆå™¨ç«¯ï¼ŒåŒæ—¶é€šè¿‡ Node æ‰©å±•çš„æ–¹å¼å¯ä»¥å¾ˆæ–¹ä¾¿è·‘åœ¨ Node ç¯å¢ƒä¸­ã€‚
2. éµå¾ªçš„è§„èŒƒä¸åŒã€‚ç‰ä¼¯è®¤ä¸ºï¼Œreturn è¿˜æ˜¯ module.exportsï¼Œå­˜ç²¹æ˜¯ä¸ªäººä¹ æƒ¯çš„åŒºåˆ†ï¼Œæ²¡æœ‰ä¼˜åŠ£
3. æ ¸å¿ƒå·®å¼‚  =>  é¢„åŠ è½½ vs æ‡’åŠ è½½

* AMD é¢„åŠ è½½ defineå³æ‰§è¡Œ   **æå‰æ‰§è¡Œ  ä¾èµ–å‰ç½®**
* CMD æ‡’åŠ è½½ requireæ—¶æ‰æ‰§è¡Œ   **å»¶è¿Ÿæ‰§è¡Œ  ä¾èµ–å°±è¿‘**

|      | AMD         | CMD            |
| :--- | ----------- | -------------- |
| åŠ è½½   | define åŠ è½½å®Œæˆ | define åŠ è½½å®Œæˆ    |
| æ‰§è¡Œ   | define å³æ‰§è¡Œ  | è¿è¡Œåˆ°requireæ—¶æ‰æ‰§è¡Œ |
| æ€»ç»“   | æå‰æ‰§è¡Œ  ä¾èµ–å‰ç½®  | å»¶è¿Ÿæ‰§è¡Œ  ä¾èµ–å°±è¿‘     |



å‚è€ƒ:

 [ã€Šå…¨æ ˆå¤§ç¥çš„æ¨¡å—åŒ–è§£æã€‹](https://github.com/highsea/cnblog/blob/master/%E5%9B%9E%E9%A1%BE%EF%BC%9A%E5%89%8D%E7%AB%AF%E6%A8%A1%E5%9D%97%E5%8C%96%E5%92%8CAMD%E3%80%81CMD%E8%A7%84%E8%8C%83%EF%BC%88%E5%85%A8%EF%BC%89.md)	

[jsæ¨¡å—åŒ–ç¼–ç¨‹ä¹‹å½»åº•å¼„æ‡‚CommonJSå’ŒAMD/CMD](https://www.cnblogs.com/chenguangliang/p/5856701.html)





